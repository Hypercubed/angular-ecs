/**
 * angular-ecs - An ECS framework built for AngularJS
 * @version v0.0.15
 * @link https://github.com/Hypercubed/angular-ecs
 * @author Jayson Harshbarger <>
 * @license 
 */
"use strict";!function(){function t(){var t={};this.register=function(n,e){return angular.isObject(n)?angular.extend(t,n):t[n]=e,this},this.$get=["$injector",function(n){return angular.forEach(t,function(e,i){angular.isFunction(e)&&(t[i]=n.invoke(e,null,null,i))}),t}]}angular.module("hc.ngEcs",[]).provider("$entities",t).provider("$components",t).provider("$systems",t).provider("$families",t)}(),function(){angular.module("hc.ngEcs").factory("Entity",["$components",function(t){function n(){var t=(new Date).getUTCMilliseconds();return""+r++ +"_"+t}function e(t){return!1==this instanceof e?new e(t):(this._id=t||n(),this.$componentAdded=new signals.Signal,this.$componentRemoved=new signals.Signal,void(this.$$signals={}))}function i(n,e,i){if(!t.hasOwnProperty(e))return i;var o=t[e];return"function"==typeof o?i instanceof o?i:angular.extend(new o(n),i):angular.copy(i,Object.create(o))}function o(t){return"$"!==t.charAt(0)&&"_"!==t.charAt(0)}var r=0;return e.prototype.$on=function(t,n){var e=this.$$signals[t];return e||(this.$$signals[t]=e=new signals.Signal),e.add(n,this)},e.prototype.$emit=function(t){var n=this.$$signals[t];if(n){if(arguments.length>1){var e=Array.prototype.slice.call(arguments,1);n.dispatch.apply(n,e)}else n.dispatch();return this}},e.prototype.$add=function(t,n){if(!t)throw new Error("Can't add component with undefined key.");return this[t]&&this.$remove(t),n=angular.isDefined(n)?n:{},"$"===t.charAt(0)||"_"===t.charAt(0)?void(this[t]=n):(this[t]=i(this,t,n),this.$componentAdded.dispatch(this,t),this)},e.prototype.$remove=function(t){return o(t)&&this.$componentRemoved.dispatch(this,t),delete this[t],this},e}])}(),function(){function t(n){var e=[];Object.defineProperty(e,"require",{enumerable:!1,writable:!1,value:n}),Object.defineProperty(e,"entityAdded",{enumerable:!1,value:new signals.Signal}),Object.defineProperty(e,"entityRemoved",{enumerable:!1,value:new signals.Signal});for(var i in t.prototype)t.prototype.hasOwnProperty(i)&&Object.defineProperty(e,i,{enumerable:!1,value:t.prototype[i]});return e}t.prototype.isMatch=function(t){return this.require?this.require.every(function(n){return t.hasOwnProperty(n)}):!0},t.prototype.add=function(t){var n=this.indexOf(t);0>n&&(this.push(t),this.entityAdded.dispatch(t))},t.prototype.addIfMatch=function(t){this.isMatch(t)&&this.add(t)},t.prototype.remove=function(t){var n=this.indexOf(t);n>-1&&(this.splice(n,1),this.entityRemoved.dispatch(t))},t.prototype.removeIfMatch=function(t){this.isMatch(t)&&this.remove(t)},t.makeId=function(t){return t?"string"==typeof t?t:t.sort().join("::"):"::"},angular.module("hc.ngEcs").constant("Family",t)}(),function(){angular.module("hc.ngEcs").service("ngEcs",["$rootScope","$log","$timeout","$components","$systems","$entities","$families","Entity","Family",function(t,n,e,i,o,r,a,s,u){function c(t){this.components=i,this.systems=o,this.entities=r,this.families=a,angular.forEach(o,function(t,n){this.$s(n,t)}),angular.forEach(r,function(t){this.$e(t)}),this.$playing=!1,this.$requestId=null,this.$fps=60,this.$interval=1,this.$systemsQueue=[],this.started=new signals.Signal,this.stopped=new signals.Signal,angular.extend(this,t)}function d(t,n){angular.forEach(a,function(e){e.require&&n&&e.require.indexOf(n)<0||e.addIfMatch(t)})}function p(t,n){angular.forEach(a,function(e){!e.require||n&&e.require.indexOf(n)<0||e.removeIfMatch(t)})}c.prototype.constructor=c,c.prototype.$c=function(t,n){i[t]=n},c.prototype.$f=function(t){var n=u.makeId(t),e=a[n];return e?e:e=a[n]=new u(t)};var h=angular.isDefined;return c.prototype.$s=function(t,n){if(o[t]=n,this.$systemsQueue.unshift(n),n.$family=this.$f(n.$require),n.$addEntity&&n.$family.entityAdded.add(n.$addEntity,n),n.$removeEntity&&n.$family.entityRemoved.add(n.$removeEntity,n),n.$updateEach){var e=n.$update?n.$update.bind(n):function(){};n.$update=function(t){e(t);for(var i=this.$family,o=i.length;o--;)o in i&&n.$updateEach(i[o],t)}}if(h(n.interval)&&h(n.$update)){var i=n.$update.bind(n);n.acc=h(n.acc)?n.acc:0,n.$update=function(t){this.acc+=t,this.acc>this.interval&&(i(t),this.acc=this.acc-this.interval)}}return h(n.$started)&&this.started.add(n.$started,n),h(n.$stopped)&&this.stopped.add(n.$stopped,n),h(n.$added)&&n.$added(),n},c.prototype.$e=function(t,n){"object"==typeof t&&(n=t,t=null);var e=new s(t);return e.$world=this,Array.isArray(n)?n.forEach(function(t){e.$add(t)}):angular.forEach(n,function(t,n){e.$add(n,t)}),d(e),e.$componentAdded.add(d,this),e.$componentRemoved.add(p,this),r[e._id]=e,e},c.prototype.$$removeEntity=function(t){t.$world=null,angular.forEach(t,function(n,e){"$"!==e.charAt(0)&&"_"!==e.charAt(0)&&t.$remove(e)}),angular.forEach(a,function(n){n.remove(t)}),t.$componentAdded.dispose(),t.$componentRemoved.dispose(),delete this.entities[t._id]},c.prototype.$update=function(t){t=angular.isUndefined(t)?this.$interval:t;for(var n,e=this.$systemsQueue,i=e.length;i--;)n=e[i],n.$update&&n.$family.length>0&&n.$update(t)},c.prototype.$render=function(t){t=angular.isUndefined(t)?this.$interval:t;for(var n,e=this.$systemsQueue,i=e.length;i--;)n=e[i],n.$render&&n.$render(t)},c.prototype.$runLoop=function(){function n(){if(o.$playing&&!o.$paused){for(e=window.performance.now(),s=Math.min(1,(e-r)/1e3),a+=s,i=1/o.$fps;a>i;)a-=i,o.$update(i);t.$applyAsync(function(){o.$render(s)}),r=e,o.$requestId=window.requestAnimationFrame(n)}}var e,i,o=this,r=window.performance.now(),a=0,s=0;o.$requestId=window.requestAnimationFrame(n)},c.prototype.$start=function(){this.$playing||(this.$playing=!0,this.started.dispatch(),this.$runLoop())},c.prototype.$stop=function(){this.$playing=!1,window.cancelAnimationFrame(this.$requestId),this.stopped.dispatch()},c.prototype.$pause=function(){this.$playing&&(this.$paused=!0)},c.prototype.$unpause=function(){this.$playing&&this.$paused&&(this.$paused=!1,this.$runLoop())},new c}])}(),function(){window.performance=window.performance||{},window.performance.now=function(){return window.performance.now||window.performance.webkitNow||window.performance.msNow||window.performance.mozNow||Date.now||function(){return(new Date).getTime()}}(),window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(function(){var n=window.performance.now();t(n)},16)}}(),window.cancelAnimationFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}}(),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var n=Array.prototype.slice.call(arguments,1),e=this,i=function(){},o=function(){return e.apply(this instanceof i?this:t,n.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,o.prototype=new i,o})}();